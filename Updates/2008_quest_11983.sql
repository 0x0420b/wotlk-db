-- q.11983 'Blood Oath of the Horde'

-- missing equip added
DELETE FROM creature_equip_template WHERE entry IN (2524);
INSERT INTO creature_equip_template (entry, equipentry1, equipentry2, equipentry3) VALUES
(2524, 41977, 0, 0);
UPDATE creature_template SET EquipmentTemplateId = 632 WHERE `entry` = 26432;
UPDATE creature_template SET EquipmentTemplateId = 2524 WHERE `entry` = 26433;


-- Taunka'le Refugees - must work as spellclick
DELETE FROM npc_spellclick_spells WHERE npc_entry IN (26179,26184);
INSERT INTO npc_spellclick_spells (npc_entry, spell_id, quest_start, quest_start_active, quest_end, cast_flags, condition_id) VALUES
(26179, 47028, 11983, 1, 11983, 2, 0),
(26184, 47028, 11983, 1, 11983, 2, 0);

-- Gossips added
-- NpcFlags set to avoid console errors - will be removed by EAI on spawn
UPDATE creature_template SET NpcFlags = 1, GossipMenuId = 9302 WHERE entry IN (26179,26184);
DELETE FROM gossip_menu WHERE entry IN (9302,9303,9304,9305);
INSERT INTO gossip_menu (entry, text_id, script_id, condition_id) VALUES
(9302, 12611, 930201, 0),
(9303, 12620, 0, 0),
(9304, 12619, 0, 0),
(9305, 12618, 0, 0);
DELETE FROM gossip_menu_option WHERE menu_id IN (9302,9303,9304,9305);
INSERT INTO gossip_menu_option (menu_id,id,option_icon,option_text,option_id,npc_option_npcflag,action_menu_id,action_poi_id,action_script_id,box_coded,box_money,box_text,condition_id) VALUES
(9302, 0, 0, 'Worry no more, taunka. The Horde will save and protect you and your people, but first you must swear allegiance to the Warchief by taking the blood oath of the Horde.', 1, 1, 9305, 0, 930202, 0, 0, NULL, 0),
(9303, 0, 0, 'For the Horde!
 
Arm yourself from the crates that surround us and report to Agmar\'s Hammer, east of here. Your first trial as a member of the Horde is to survive the journey.
 
Lok\'tar ogar!', 1, 1, 0, 0, 930203, 0, 0, NULL, 0),
(9304, 0, 0, 'Then repeat after me: "Lok\'tar ogar! Victory or death - it is these words that bind me to the Horde. For they are the most sacred and fundamental of truths to any warrior of the Horde.
 
I give my flesh and blood freely to the Warchief. I am the instrument of my Warchief\'s desire. I am a weapon of my Warchief\'s command.
 
From this moment until the end of days I live and die - For the Horde!"', 1, 1, 9303, 0, 0, 0, 0, NULL, 0),
(9305, 0, 0, 'Yes, taunka. Retribution is a given right of all members of the Horde.', 1, 1, 9304, 0, 0, 0, 0, NULL, 0);

DELETE FROM dbscripts_on_gossip WHERE id BETWEEN 930201 AND 930203;
INSERT INTO dbscripts_on_gossip (id, delay, command, datalong, datalong2, datalong3, buddy_entry, search_radius, data_flags, dataint, dataint2, dataint3, dataint4, x, y, z, o, comments) VALUES
(930201,100,35,5,1,0,0,0,6,0,0,0,0,0,0,0,0,'Send Event B - safety check in case: if dumped'),
(930202,100,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,''),
(930202,200,14,16093,0,0,0,0,0x04,0,0,0,0,0,0,0,0,''),
(930202,300,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,''),
(930202,500,21,1,0,0,0,0,0x04,0,0,0,0,0,0,0,0,'active'),
(930202,1000,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,''),
(930203,100,2,82,0,0,0,0,0x04,0,0,0,0,0,0,0,0,''),
(930203,300,25,1,0,0,0,0,0x04,0,0,0,0,0,0,0,0,''),
(930203,200,8,26179,0,0,0,0,0,0,0,0,0,0,0,0,0,''),
(930203,1000,20,2,0,0,0,0,0x04,0,0,0,0,0,0,0,0,'');
DELETE FROM dbscript_string WHERE entry = 2000020294;
INSERT INTO dbscript_string (entry, content_default, sound, type, language, emote, comment) VALUES
(2000020294,'Victory or death! For the Horde!',0,1,0,15,NULL);

-- Waypoints -- will be used by scripts
UPDATE creature SET spawndist = 0, MovementType = 0 WHERE id  IN (26179,26184);
DELETE FROM creature_movement WHERE id IN (SELECT guid FROM creature WHERE id IN (26179,26184));
INSERT INTO creature_movement (id,point,position_x,position_y,position_z,orientation,waittime,script_id) VALUES
-- 5712405
(5712405,1,3788.35,2853.22,90.8538,3.64588,7000,2617901),
(5712405,2,3784.66,2854.33,90.9711,3.26654,0,0),
(5712405,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712406
(5712406,1,3778.07,2845.38,90.7005,1.72073,0,0),
(5712406,2,3780.67,2850.07,90.8773,0.416966,7000,2617901),
(5712406,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712407
(5712407,1,3766.22,2924.84,90.6979,5.22993,7000,2617901),
(5712407,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712408
(5712408,1,3798.46,2861.91,90.0241,3.62823,0,0),
(5712408,2,3787.78,2852.81,90.9445,3.70284,7000,2617901),
(5712408,3,3785.24,2854.6,90.9735,3.21479,0,0),
(5712408,4,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712409
(5712409,1,3775.55,2848.74,90.6713,1.47653,0,0),
(5712409,2,3780.87,2850.72,90.8647,0.0773769,7000,2617901),
(5712409,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712410
(5712410,1,3788.35,2853.22,90.8538,3.64588,7000,2617901),
(5712410,2,3784.66,2854.33,90.9711,3.26654,0,0),
(5712410,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712411
(5712411,1,3720.75,2893.16,92.4665,0.0251656,7000,2617901),
(5712411,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712412
(5712412,1,3743.41,2875.37,92.7316,4.725,7000,2617901),
(5712412,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712413
(5712413,1,3784.37,2853.31,90.9711,4.16942,7000,2617901),
(5712413,2,3781.06,2854.59,90.6864,3.38481,0,0),
(5712413,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712414
(5712414,1,3734.85,2833.19,90.7321,0.900158,7000,2617901),
(5712414,2,3715.55,2842.36,89.3116,3.43542,0,0),
(5712414,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712415
(5712415,1,3762.82,2863.74,93.6663,5.60468,7000,2617901),
(5712415,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712416
(5712416,1,3758.66,2883.44,93.2377,2.23909,7000,2617901),
(5712416,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712417
(5712417,1,3721.54,2891.98,92.1343,0.624424,7000,2617901),
(5712417,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712418
(5712418,1,3766.22,2924.84,90.6979,5.22993,7000,2617901),
(5712418,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712419
(5712419,1,3763.34,2920.49,90.7518,0.679404,7000,2617901),
(5712419,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712420
(5712420,1,3763.34,2920.49,90.7518,0.679404,7000,2617901),
(5712420,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712421
(5712421,1,3755.82,2884.64,93.1148,0.283958,7000,2617901),
(5712421,2,3737.43,2878.55,92.6488,3.14515,0,0),
(5712421,3,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712422
(5712422,1,3716.55,2868.71,90.9929,1.43702,7000,2617901),
(5712422,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712423
(5712423,1,3716.55,2868.71,90.9929,1.43702,7000,2617901),
(5712423,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712424
(5712424,1,3721.54,2891.98,92.1343,0.624424,7000,2617901),
(5712424,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712425
(5712425,1,3766.22,2924.84,90.6979,5.22993,7000,2617901),
(5712425,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712426
(5712426,1,3718.14,2895.93,93.0176,5.24934,0,0),
(5712426,2,3721.2,2893.85,92.4909,5.72451,7000,2617901),
(5712426,3,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712427
(5712427,1,3780.83,2849.89,90.8792,0.680035,7000,2617901),
(5712427,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712428
(5712428,1,3788.35,2853.22,90.8538,3.64588,7000,2617901),
(5712428,2,3784.66,2854.33,90.9711,3.26654,0,0),
(5712428,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712429
(5712429,1,3727.38,2904.75,92.5904,0.584292,7000,2617901),
(5712429,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712430
(5712430,1,3783.53,2930.37,90.5202,3.76101,0,0),
(5712430,2,3768.12,2921.32,90.6927,3.32511,7000,2617901),
(5712430,3,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712431
(5712431,1,3766.22,2924.84,90.6979,5.22993,7000,2617901),
(5712431,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712432
(5712432,1,3798.46,2861.91,90.0241,3.62823,0,0),
(5712432,2,3787.78,2852.81,90.9445,3.70284,7000,2617901),
(5712432,3,3785.24,2854.6,90.9735,3.21479,0,0),
(5712432,4,3704.46,2833.78,88.52,3.89389,2000,2617902), 
-- 5712433
(5712433,1,3778.07,2845.38,90.7005,1.72073,0,0),
(5712433,2,3780.67,2850.07,90.8773,0.416966,7000,2617901),
(5712433,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712434
(5712434,1,3780.83,2849.89,90.8792,0.680035,7000,2617901),
(5712434,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712435
(5712435,1,3764.24,2864.68,93.8739,4.75252,7000,2617901),
(5712435,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712436
(5712436,1,3740.11,2835.91,90.8042,3.19509,7000,2617901),
(5712436,2,3736.31,2842.52,90.3941,2.80474,0,0),
(5712436,3,3717.68,2844.87,89.4613,3.14639,0,0),
(5712436,4,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712437
(5712437,1,3734.85,2833.19,90.7321,0.900158,7000,2617901),
(5712437,2,3715.55,2842.36,89.3116,3.43542,0,0),
(5712437,3,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712438
(5712438,1,3714.8,2869.17,91.2121,0.673154,7000,2617901),
(5712438,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712439
(5712439,1,3740.11,2835.91,90.8042,3.19509,7000,2617901),
(5712439,2,3736.31,2842.52,90.3941,2.80474,0,0),
(5712439,3,3717.68,2844.87,89.4613,3.14639,0,0),
(5712439,4,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712440
(5712440,1,3762.82,2863.74,93.6663,5.60468,7000,2617901),
(5712440,2,3704.46,2833.78,88.52,3.89389,2000,2617902),
-- 5712441
(5712441,1,3743.41,2875.37,92.7316,4.725,7000,2617901),
(5712441,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712442
(5712442,1,3763.56,2921.31,90.7402,0.155466,7000,2617901),
(5712442,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712443
(5712443,1,3757.9,2883.02,93.5097,2.00868,7000,2617901),
(5712443,2,3738.15,2878.7,92.6851,3.24568,0,0),
(5712443,3,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712444
(5712444,1,3721.54,2891.98,92.1343,0.624424,7000,2617901),
(5712444,2,3678.04,2873.91,91.1575,3.41027,2000,2617902),
-- 5712445
(5712445,1,3716.55,2868.71,90.9929,1.43702,7000,2617901),
(5712445,2,3704.46,2833.78,88.52,3.89389,2000,2617902);
-- Scripts
DELETE FROM dbscripts_on_creature_movement WHERE id IN (2617901,2617902);
INSERT INTO dbscripts_on_creature_movement (id, delay, command, datalong, datalong2, datalong3, buddy_entry, search_radius, data_flags, dataint, dataint2, dataint3, dataint4, x, y, z, o, comments) VALUES
(2617901,2000,15,47024,0,0,0,0,0,0,0,0,0,0,0,0,0,''),
(2617901,5000,0,0,0,0,0,0,0,2000020294,0,0,0,0,0,0,0,''),
(2617902,1000,18,0,0,0,0,0,0x04,0,0,0,0,0,0,0,0,'desp'),
(2617902,1100,21,0,0,0,0,0,0x04,0,0,0,0,0,0,0,0,'unactive');
-- random transform
DELETE FROM dbscripts_on_spell WHERE id = 47024;
INSERT INTO dbscripts_on_spell (id, delay, command, datalong, datalong2, datalong3, buddy_entry, search_radius, data_flags, dataint, dataint2, dataint3, dataint4, x, y, z, o, comments) VALUES
(47024,0,15,47023,0,0,0,0,0,47022,0,0,0,0,0,0,0,'');

